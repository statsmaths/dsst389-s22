---
title: "Notebook 08"
output:
  html_document:
    theme: cosmo
    highlight: zenburn
    css: "../css/note-style.css"
---

## Getting Started

Before running this notebook, select "Session > Restart R and Clear Output" in
the menu above to start a new R session. You may also have to hit the broom in
the upper right-hand corner of the window. This will clear any old data sets and
give us a blank slate to start with.

After starting a new session, run the following code chunk to load the
libraries and data that we will be working with today.

```{r, message=FALSE, echo=FALSE}
source("../funs/funs.R")
source("../funs/funs_custom.R")
```

I have set the options `message=FALSE` and `echo=FALSE` to avoid cluttering
your solutions with all the output from this code.

## Reading the Data

```{r, message = FALSE}
docs <- read_csv("../data/newsgroups.csv.bz2")
anno <- read_csv("../data/newsgroups_token.csv.bz2")
```

## Questions

```{r, question-01}
dsst_kmeans(anno, docs, doc_var = "label")
```

```{r, question-01}
model <- dsst_hclust(anno, docs, doc_var = "label")
```

```{r, question-01}
dsst_pca(anno, docs, doc_var = "label") %>% dsst_plot_dred()
```

```{r, question-01}
dsst_umap(anno, docs, doc_var = "label") %>% dsst_plot_dred()
```

```{r, question-01}
dsst_pca(anno) %>%
  left_join(select(docs, -text), by = "doc_id") %>%
  mutate(subject = stringi::stri_extract(label, regex = "[a-z]+\\.")) %>%
  ggplot(aes(v1, v2)) +
    geom_point(aes(color = subject))
```

```{r, question-01}
dsst_umap(anno) %>%
  left_join(select(docs, -text), by = "doc_id") %>%
  mutate(subject = stringi::stri_extract(label, regex = "[a-z]+\\.")) %>%
  ggplot(aes(v1, v2)) +
    geom_point(aes(color = subject), show.legend = FALSE) +
    facet_wrap(~subject)
```
